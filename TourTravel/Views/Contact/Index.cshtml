 <!-- contact area -->
@model TourTravel.Models.WebsiteSetting
@await Component.InvokeAsync("HeroSection")
<div class="contact-area py-120">
    <div class="container">
        <div class="contact-wrapper">
            <div class="row">
                <div class="col-md-6">
                    <div class="contact-map">
                        <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d96708.34194156103!2d-74.03927096447748!3d40.759040329405195!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x0%3A0x4a01c8df6fb3cb8!2sSolomon%20R.%20Guggenheim%20Museum!5e0!3m2!1sen!2sbd!4v1619410634508!5m2!1sen!2s" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
                    </div>
                </div>
                <div class="col-md-6 align-self-center">
                    <div class="contact-form">
                        <div class="contact-form-header text-center mb-4">
                            <h2 class="fw-bold">Get In Touch</h2>
                            <p class="text-muted">We'd love to hear from you. Please fill out the form below.</p>
                        </div>
                        <form method="post" action="/travelox/assets/php/contact.php" id="contact-form">
                            <div class="row g-4">
                                <div class="col-md-6">
                                    <label class="form-label fw-semibold">Full Name</label>
                                    <div class="input-group modern-input-group">
                                        <span class="input-group-text"><i class="far fa-user"></i></span>
                                        <input type="text" name="name" class="form-control modern-input" placeholder="Your Name" required>
                                    </div>
                                </div>

                                <div class="col-md-6">
                                    <label class="form-label fw-semibold">Email</label>
                                    <div class="input-group modern-input-group">
                                        <span class="input-group-text"><i class="far fa-envelope"></i></span>
                                        <input type="email" name="email" class="form-control modern-input" placeholder="Your Email" required>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <label class="form-label fw-semibold">Phone Number</label>
                                    <div class="input-group modern-input-group">
                                        <span class="input-group-text"><i class="far fa-phone"></i></span>
                                        <input type="text" name="PhoneNumber" class="form-control modern-input" placeholder="Your Phone Number" required>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <label class="form-label fw-semibold">Subject</label>
                                    <div class="input-group modern-input-group">
                                        <span class="input-group-text"><i class="far fa-comment-dots"></i></span>
                                        <input type="text" name="subject" class="form-control modern-input" placeholder="Your Subject" required>
                                    </div>
                                </div>
                                <div class="col-md-12">
                                    <label class="form-label fw-semibold">Message</label>
                                    <textarea name="message" class="form-control modern-textarea" rows="5" placeholder="Write your message..." required></textarea>
                                </div>
                               
                            </div>
                            <div class="text-center mt-4">
                                <button type="submit" class="contact-btn-modern">
                                    <i class="far fa-paper-plane me-2"></i>Send Message
                                </button>
                            </div>

                            <div id="form-message" class="mt-3"></div>
                        </form>

                    </div>
                </div>
            </div>
        </div>

        <div class="contact-content">
            <div class="row">
                <div class="col-md-6 col-lg-3">
                    <div class="contact-info">
                        <i class="far fa-map-marker-alt"></i>
                        <h5>Office Address</h5>
                        <p>@Model.Address</p>
                    </div>
                </div>
                <div class="col-md-6 col-lg-3">
                    <div class="contact-info">
                        <i class="far fa-phone"></i>
                        <h5>Call Us</h5>
                        <p>@Model.Phone</p>
                    </div>
                </div>
                <div class="col-md-6 col-lg-3">
                    <div class="contact-info">
                        <i class="far fa-envelope"></i>
                        <h5>Email Us</h5>
                        <p>@Model.Email</p>
                    </div>
                </div>
                <div class="col-md-6 col-lg-3">
                    <div class="contact-info">
                        <i class="far fa-clock"></i>
                        <h5>Office Open</h5>
                        <p>@Model.Timing</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        async function showToast(message, cssClass) {
            const container = document.getElementById('form-message');
            container.textContent = message;
            container.className = 'mt-2 ' + cssClass;

            setTimeout(() => {
                container.textContent = '';
                container.className = '';
            }, 3000);
        }

        document.getElementById("contact-form").addEventListener("submit", async function (e) {
            e.preventDefault();

            const phoneNumber = this.PhoneNumber.value.trim();  // ✅ FIXED

            const formData = {
                name: this.name.value,
                email: this.email.value,
                phoneNumber: phoneNumber,
                subject: this.subject.value,
                message: this.message.value
            };

            const phoneRegex = /^[6-9]\d{9}$/;   // ✅ Indian 10-digit mobile numbers

            if (!phoneRegex.test(phoneNumber)) {
                return showToast("Enter a valid 10-digit mobile number starting with 6–9.", "text-danger");
            }

            try {
                const response = await fetch('https://stg-jungleave-back.jobvritta.com/api/contact/addContactEnquiry', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer eyJhbGciOi...'
                    },
                    body: JSON.stringify(formData)
                });

                const result = await response.json();

                if (response.ok && result) {
                    showToast('Message sent successfully!', 'text-success');
                    this.reset();
                } else {
                    showToast(result?.message || 'Failed to send message.', 'text-danger');
                }
            } catch (err) {
                console.error(err);
                showToast('An error occurred while sending the message.', 'text-danger');
            }
        });

    </script>
}

<!-- end contact area -->
